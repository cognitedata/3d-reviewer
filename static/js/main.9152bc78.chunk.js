(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{153:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(55),r=n(0),o=n.n(r),i=n(33),c=o.a.shape({id:o.a.number.isRequired,name:o.a.string.isRequired}),u=(o.a.shape({loading:o.a.bool.isRequired,items:o.a.arrayOf(c).isRequired}),{loading:!1,items:[]});function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.a.FETCH_MODELS:return Object(a.a)({},e,{loading:!0,items:[]});case i.a.SET_MODELS:return Object(a.a)({},e,{loading:!1,items:t.payload});default:return e}}},154:function(e,t,n){var a=n(746).default;e.exports=a()},218:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(45),r=n(351),o=n(55),i=n(0),c=n.n(i),u=n(33),s=c.a.shape({author:c.a.string.isRequired,content:c.a.string.isRequired,datetime:c.a.string.isRequired}),d=(c.a.shape({loading:c.a.bool.isRequired,items:c.a.arrayOf(s).isRequired}),{});function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.a.ADD_COMMENT:var n=t.payload,i=n.comment,c=n.nodeId;return Object(o.a)({},e,Object(a.a)({},c,Object(o.a)({},e[c],{items:[].concat(Object(r.a)(e[c].items),[i])})));case u.a.SET_COMMENTS:var s=t.payload,l=s.items,m=s.nodeId;return Object(o.a)({},e,Object(a.a)({},m,{loading:!1,items:l}));case u.a.FETCH_COMMENTS:var p=t.payload.nodeId;return Object(o.a)({},e,Object(a.a)({},p,{loading:!0,items:[]}));default:return e}}},219:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(55),r=n(0),o=n.n(r),i=n(33),c=o.a.shape({id:o.a.number.isRequired,thumbnailURL:o.a.string.isRequired}),u=(o.a.shape({loading:o.a.bool.isRequired,items:o.a.arrayOf(c).isRequired}),{loading:!1,items:[]});function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.a.FETCH_REVISIONS:return Object(a.a)({},e,{loading:!0,items:[]});case i.a.SET_REVISIONS:return Object(a.a)({},e,{loading:!1,items:t.payload});default:return e}}},33:function(e,t,n){"use strict";t.a={SET_COMMENTS:"SET_COMMENTS",ADD_COMMENT:"ADD_COMMENT",FETCH_COMMENTS:"FETCH_COMMENTS",FETCH_MODELS:"FETCH_MODELS",SET_MODELS:"SET_MODELS",FETCH_REVISIONS:"FETCH_REVISIONS",SET_REVISIONS:"SET_REVISIONS"}},357:function(e,t,n){e.exports=n(745)},744:function(e,t,n){},745:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(8),i=n(42),c=n(154),u=n.n(c),s=n(754),d=n(757),l=n(758),m=n(63),p=n(328),h=n(756),f=n(39),v=n.n(f),b=n(67),E=n(74),O=n(75),y=n(78),g=n(76),j=n(79),S=n(164),I=n(753),w=n(751),C=n(755),T=n(749),M=n(44),D=n(748);var R=function(e){var t=e.author,n=e.avatar,a=e.content,o=e.datetime;return r.a.createElement(D.a,{author:t,avatar:n,content:a,datetime:o})},N=w.a.toString;var _=function(e){var t=e.loading,n=e.comments,a=e.onComment,o="";return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{header:"".concat(n.length," comment").concat(n.length>1?"s":""),itemLayout:"horizontal",dataSource:n,loading:t,locale:{emptyText:"No comments"},renderItem:function(e){return r.a.createElement("li",null,r.a.createElement(R,{actions:e.actions,author:e.author,avatar:r.a.createElement(T.a,{size:"large",icon:"user"}),content:e.content,datetime:e.datetime}))}}),t||r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{width:"100%",height:100},onChange:function(e){o=N(e)},defaultSuggestions:["Fredrik Anfinsen","Anders Hafreager"],multiLines:!0,autoFocus:!0,placeholder:"Type in a new comment here"}),r.a.createElement(M.a,{type:"primary",block:!0,style:{top:10},onClick:function(){a(o)}},"Comment")))},k=n(45),x=n(21),F=n(33),L="3D_MODEL_ID",q="3D_REVISION_ID",H="3D_NODE_ID",A=function(e,t){return{type:F.a.ADD_COMMENT,payload:{nodeId:e,comment:t}}};n(218);var U=function(e,t){return e.comments[t]||{items:[],loading:!1}},V=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(y.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).onComment=function(e){var t=n.props,a=t.modelId,r=t.revisionId,o=t.nodeId;(0,t.onSubmitComment)(a,r,o,{content:e,author:"fredrik.anfinsen@cognite.com"})},n.fetchData=function(){var e=n.props,t=e.modelId,a=e.revisionId,r=e.nodeId;(0,e.doFetchComments)(t,a,r)},n}return Object(j.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){var t=this.props.nodeId;e.nodeId!==t&&this.fetchData()}},{key:"render",value:function(){var e=this.props,t=e.comments,n=e.onClose;return r.a.createElement(I.a,{title:"Comments",placement:"right",width:400,closable:!0,onClose:n,visible:!0,mask:!1},r.a.createElement(_,{loading:t.loading,comments:t.items,onComment:this.onComment}))}}]),t}(r.a.Component),z=Object(i.b)(function(e,t){var n=t.nodeId;return{comments:U(e,n)}},function(e){return{doFetchComments:function(){return e(function(e,t,n){return function(){var a=Object(b.a)(v.a.mark(function a(r){var o,i,c;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(void 0===u.a.getState().comments[n]){a.next=2;break}return a.abrupt("return");case 2:return r({type:F.a.FETCH_COMMENTS,payload:n}),a.next=5,x.Events.search({metadata:(o={},Object(k.a)(o,L,e),Object(k.a)(o,q,t),Object(k.a)(o,H,n),o),sort:"createdTime",dir:"asc"});case 5:i=a.sent,c=i.items.map(function(e){return{author:e.metadata.author,content:e.description,datetime:new Date(e.createdTime).toDateString()}}),r({type:F.a.SET_COMMENTS,payload:{nodeId:n,items:c}});case 8:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}.apply(void 0,arguments))},onSubmitComment:function(){return e(function(e,t,n,a){return function(){var r=Object(b.a)(v.a.mark(function r(o){var i,c,u,s;return v.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c=a.author,u=a.content,i={author:c},Object(k.a)(i,L,e),Object(k.a)(i,q,t),Object(k.a)(i,H,n),s=i,r.next=4,x.Events.create([{description:u,source:"3d-reviewer",type:"Comment",metadata:s}]);case 4:o(A(n,{author:a.author,content:a.content,datetime:(new Date).toDateString()}));case 5:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}()}.apply(void 0,arguments))}}})(V),B=function(e){function t(){var e,n;Object(E.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(y.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={model:null},n.onViewerReady=function(e,t){n.setState({model:t})},n.onClick=function(){var e=Object(b.a)(v.a.mark(function e(t){var a,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return n.onCommentsClose(),e.abrupt("return");case 3:a=n.props,r=a.match,a.history.push("".concat(r.url,"/comments/").concat(t));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onCommentsClose=function(){var e=n.state.model,t=n.props,a=t.match,r=t.history;e.deselectAllNodes(),r.push(a.url)},n.selectNode=function(e){var t=n.state.model;t&&(t.deselectAllNodes(),t.selectNode(Number(e)))},n}return Object(j.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.modelId,a=t.revisionId,o=t.match;return r.a.createElement("div",{className:"main-layout",style:{width:"100%",height:"100vh"}},r.a.createElement(S.a,{modelId:n,revisionId:a,onClick:this.onClick,onReady:this.onViewerReady}),r.a.createElement(l.a,{exact:!0,path:"".concat(o.url,"/comments/:nodeId"),render:function(t){var o=t.match.params.nodeId;return e.selectNode(Number(o)),r.a.createElement(z,{loading:!0,modelId:n,revisionId:a,nodeId:Number(o),onClose:e.onCommentsClose})}}))}}]),t}(r.a.Component),J=Object(i.b)(function(e,t){var n=t.match.params,a=n.modelId,r=n.revisionId;return{modelId:Number(a),revisionId:Number(r)}})(B);n(153);var P=n(11),W=n(750);var G=function(e){var t=e.loading,n=e.items;return r.a.createElement(C.a,{header:"".concat(n.length," model").concat(n.length>1?"s":""),itemLayout:"horizontal",dataSource:n,loading:t,locale:{emptyText:"No models. Please upload a 3D model first: https://doc.cognitedata.com/dev/guides/3d/upload-3d.html"},renderItem:function(e){return r.a.createElement("li",null,r.a.createElement(W.a,{to:"models/".concat(e.id,"/revisions")},r.a.createElement(P.a,{type:"code-sandbox"}),e.name))}})},$=function(e){function t(){return Object(E.a)(this,t),Object(y.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.doFetchModels)()}},{key:"render",value:function(){var e=this.props.models;return r.a.createElement(G,{loading:e.loading,items:e.items})}}]),t}(r.a.Component),K=Object(i.b)(function(e){return{models:e.models}},function(e){return{doFetchModels:function(){return e(function(){var e=Object(b.a)(v.a.mark(function e(t){var n,a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:F.a.FETCH_MODELS}),e.next=3,x.ThreeD.listModels();case 3:n=e.sent,a=n.items.map(function(e){return{name:e.name,id:e.id}}),t({type:F.a.SET_MODELS,payload:a});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}}})($),Q=n(157),X=(n(219),n(352)),Y=n(129),Z=n(752),ee=n(14);function te(){var e=Object(Y.a)(["\n  width: 100%;\n  cursor: pointer;\n  padding: 16px !important;\n  background: none !important;\n  border: none !important;\n\n  .ant-card-body {\n    background: white;\n    border: 1px solid #e8e8e8 !important;\n    border-radius: 0 0 5px 5px;\n  }\n\n  @media screen and (min-width: 920px) {\n    width: 50%;\n  }\n\n  @media screen and (min-width: 1220px) {\n    width: 33%;\n  }\n\n  @media screen and (min-width: 1920px) {\n    width: 25%;\n  }\n"]);return te=function(){return e},e}var ne=Z.a.Meta,ae=Object(ee.a)(Z.a)(te()),re=function(e){var t=e.thumbnailURL,n=e.revisionId,o=Object(a.useState)(""),i=Object(X.a)(o,2),c=i[0],u=i[1];return Object(a.useEffect)(function(){var e=!1;return x.rawGet(t,{responseType:"blob"}).then(function(t){if(!e){var n=t.data,a=URL.createObjectURL(n);u(a)}}).catch(function(e){console.error(e)}),function(){e=!0}},[t]),r.a.createElement(ae,{cover:r.a.createElement(W.a,{to:"revisions/".concat(n),style:{textAlign:"center"}},r.a.createElement("img",{alt:"Single revision",src:c,style:{height:225,objectFit:"cover",width:"100%"}}))},r.a.createElement(W.a,{to:"revisions/".concat(n)},r.a.createElement(ne,{title:"Revision",description:"Click to view"})))};var oe=function(e){function t(){return Object(E.a)(this,t),Object(y.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.doFetchRevisions,n=e.match;t(Number(n.params.modelId))}},{key:"render",value:function(){var e=this.props.revisions;return e.loading?r.a.createElement(Q.a,{size:"large"}):r.a.createElement(r.a.Fragment,null,e.items.map(function(e){return r.a.createElement(re,{key:e.id,revisionId:e.id,thumbnailURL:e.thumbnailURL})}))}}]),t}(r.a.Component),ie=Object(i.b)(function(e){return{revisions:e.revisions}},function(e){return{doFetchRevisions:function(t){return e(function(e){return function(){var t=Object(b.a)(v.a.mark(function t(n){var a,r;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:F.a.FETCH_REVISIONS,payload:e}),t.next=3,x.ThreeD.listRevisions(e);case 3:a=t.sent,r=a.items.filter(function(e){return"Done"===e.status}).map(function(e){return{id:e.id,thumbnailURL:e.thumbnailURL}}),n({type:F.a.SET_REVISIONS,payload:r});case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(t))}}})(oe),ce="models/:modelId/revisions/:revisionId",ue=Object(i.b)(function(e,t){return{tenant:t.match.params.tenant}})(function(e){var t=e.tenant,n=e.match;return r.a.createElement(p.a,{project:t,redirectUrl:window.location.href,errorRedirectUrl:window.location.href,usePopup:!0,enableTokenCaching:!0},r.a.createElement(d.a,null,r.a.createElement(h.a,{exact:!0,strict:!0,from:"".concat(n.url,"/").concat(ce,"/"),to:"".concat(n.url,"/").concat(ce)}),r.a.createElement(l.a,{path:"".concat(n.url,"/models/:modelId/revisions/:revisionId"),component:J}),r.a.createElement(l.a,{path:"".concat(n.url,"/models/:modelId/revisions"),component:ie}),r.a.createElement(l.a,{path:"".concat(n.url,"/models"),component:K})))});function se(){var e=Object(Y.a)(["\n  max-width: 600px;\n  min-width: 400px;\n  align-self: center;\n"]);return se=function(){return e},e}function de(){var e=Object(Y.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  height: 100vh;\n"]);return de=function(){return e},e}var le=ee.a.div(de()),me=ee.a.div(se()),pe=Object(i.b)(function(e,t){return{onTenantSelected:function(e){t.history.push("/".concat(e,"/models"))}}})(function(e){var t=e.onTenantSelected;return r.a.createElement(le,null,r.a.createElement(me,null,r.a.createElement(S.b,{title:"3D Reviewer",onTenantSelected:t,placeholder:"itera-dev"})))});Object(m.a)();var he=function(){return r.a.createElement(s.a,{basename:"/3d-reviewer"},r.a.createElement(d.a,null,r.a.createElement(l.a,{exact:!0,path:"/",component:pe}),r.a.createElement(l.a,{path:"/:tenant",component:ue})))};n(743),n(744),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(o.render)(r.a.createElement(i.a,{store:u.a},r.a.createElement(he,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},746:function(e,t,n){"use strict";n.r(t);var a=n(73),r=n(327),o=n(218),i=n(153),c=n(219),u=Object(a.combineReducers)({comments:o.a,models:i.a,revisions:c.a});n.d(t,"default",function(){return l});var s=[r.a],d=[a.applyMiddleware.apply(void 0,s)];function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.createStore.apply(void 0,[u,e].concat(d))}}},[[357,1,2]]]);
//# sourceMappingURL=main.9152bc78.chunk.js.map